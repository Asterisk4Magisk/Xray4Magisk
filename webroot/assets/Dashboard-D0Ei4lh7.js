import{c as D,d as A,u as ue,w as Re,a as Ee,b as t,n as Y,e as W,f as N,g as J,m as De,t as re,r as b,h as _,I as de,i as j,j as ce,p as Ne,k as Te,l as me,o as Ue,F,C as Fe,T as Ge,q as R,s as E,v as H,x as u,y as Le,z as U,A as O,B as K,D as P,E as C,G as oe,H as ne,J as X,K as Me,L as je,M as q,P as He,N as Oe}from"./index-BYPembx9.js";import{P as Ke,C as qe,a as We,B as Xe,L as Ye,s as se,F as Je}from"./index-BTDY2Yfi.js";const[ve,Qe]=D("radio-group"),Ze={shape:String,disabled:Boolean,iconSize:Y,direction:String,modelValue:W,checkedColor:String},he=Symbol(ve);var et=A({name:ve,props:Ze,emits:["change","update:modelValue"],setup(e,{emit:c,slots:n}){const{linkChildren:d}=ue(he),m=o=>c("update:modelValue",o);return Re(()=>e.modelValue,o=>c("change",o)),d({props:e,updateValue:m}),Ee(()=>e.modelValue),()=>{var o;return t("div",{class:Qe([e.direction]),role:"radiogroup"},[(o=n.default)==null?void 0:o.call(n)])}}});const tt=N(et),fe={name:W,disabled:Boolean,iconSize:Y,modelValue:W,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var at=A({props:J({},fe,{bem:De(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:re,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:c,slots:n}){const d=b(),m=r=>{if(e.parent&&e.bindGroup)return e.parent.props[r]},o=_(()=>{if(e.parent&&e.bindGroup){const r=m("disabled")||e.disabled;if(e.role==="checkbox"){const k=m("modelValue").length,g=m("max"),$=g&&k>=+g;return r||$&&!e.checked}return r}return e.disabled}),f=_(()=>m("direction")),s=_(()=>{const r=e.checkedColor||m("checkedColor");if(r&&e.checked&&!o.value)return{borderColor:r,backgroundColor:r}}),i=_(()=>e.shape||m("shape")||"round"),v=r=>{const{target:k}=r,g=d.value,$=g===k||(g==null?void 0:g.contains(k));!o.value&&($||!e.labelDisabled)&&c("toggle"),c("click",r)},h=()=>{var r,k;const{bem:g,checked:$,indeterminate:T}=e,B=e.iconSize||m("iconSize");return t("div",{ref:d,class:g("icon",[i.value,{disabled:o.value,checked:$,indeterminate:T}]),style:i.value!=="dot"?{fontSize:j(B)}:{width:j(B),height:j(B),borderColor:(r=s.value)==null?void 0:r.borderColor}},[n.icon?n.icon({checked:$,disabled:o.value}):i.value!=="dot"?t(de,{name:T?"minus":"success",style:s.value},null):t("div",{class:g("icon--dot__icon"),style:{backgroundColor:(k=s.value)==null?void 0:k.backgroundColor}},null)])},y=()=>{const{checked:r}=e;if(n.default)return t("span",{class:e.bem("label",[e.labelPosition,{disabled:o.value}])},[n.default({checked:r,disabled:o.value})])};return()=>{const r=e.labelPosition==="left"?[y(),h()]:[h(),y()];return t("div",{role:e.role,class:e.bem([{disabled:o.value,"label-disabled":e.labelDisabled},f.value]),tabindex:o.value?void 0:0,"aria-checked":e.checked,onClick:v},[r])}}});const lt=J({},fe,{shape:String}),[ot,nt]=D("radio");var st=A({name:ot,props:lt,emits:["update:modelValue"],setup(e,{emit:c,slots:n}){const{parent:d}=ce(he),m=()=>(d?d.props.modelValue:e.modelValue)===e.name,o=()=>{d?d.updateValue(e.name):c("update:modelValue",e.name)};return()=>t(at,Te({bem:nt,role:"radio",parent:d,checked:m(),onToggle:o},e),Ne(n,["default","icon"]))}});const it=N(st),[pe,ut]=D("row"),ge=Symbol(pe),rt={tag:me("div"),wrap:re,align:String,gutter:{type:[String,Number,Array],default:0},justify:String};var dt=A({name:pe,props:rt,setup(e,{slots:c}){const{children:n,linkChildren:d}=ue(ge),m=_(()=>{const s=[[]];let i=0;return n.forEach((v,h)=>{i+=Number(v.span),i>24?(s.push([h]),i-=24):s[s.length-1].push(h)}),s}),o=_(()=>{let s=0;Array.isArray(e.gutter)?s=Number(e.gutter[0])||0:s=Number(e.gutter);const i=[];return s&&m.value.forEach(v=>{const h=s*(v.length-1)/v.length;v.forEach((y,r)=>{if(r===0)i.push({right:h});else{const k=s-i[y-1].right,g=h-k;i.push({left:k,right:g})}})}),i}),f=_(()=>{const{gutter:s}=e,i=[];if(Array.isArray(s)&&s.length>1){const v=Number(s[1])||0;if(v<=0)return i;m.value.forEach((h,y)=>{y!==m.value.length-1&&h.forEach(()=>{i.push({bottom:v})})})}return i});return d({spaces:o,verticalSpaces:f}),()=>{const{tag:s,wrap:i,align:v,justify:h}=e;return t(s,{class:ut({[`align-${v}`]:v,[`justify-${h}`]:h,nowrap:!i})},{default:()=>{var y;return[(y=c.default)==null?void 0:y.call(c)]}})}}});const[ct,mt]=D("col"),vt={tag:me("div"),span:Ue(0),offset:Y};var ht=A({name:ct,props:vt,setup(e,{slots:c}){const{parent:n,index:d}=ce(ge),m=_(()=>{if(!n)return;const{spaces:o,verticalSpaces:f}=n;let s={};if(o&&o.value&&o.value[d.value]){const{left:v,right:h}=o.value[d.value];s={paddingLeft:v?`${v}px`:null,paddingRight:h?`${h}px`:null}}const{bottom:i}=f.value[d.value]||{};return J(s,{marginBottom:i?`${i}px`:null})});return()=>{const{tag:o,span:f,offset:s}=e;return t(o,{style:m.value,class:mt({[f]:f,[`offset-${s}`]:s})},{default:()=>{var i;return[(i=c.default)==null?void 0:i.call(c)]}})}}});const ft=N(ht),pt=N(dt),[ie,gt]=D("space"),bt={align:String,direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:8},wrap:Boolean,fill:Boolean};function be(e=[]){const c=[];return e.forEach(n=>{Array.isArray(n)?c.push(...n):n.type===F?c.push(...be(n.children)):c.push(n)}),c.filter(n=>{var d;return!(n&&(n.type===Fe||n.type===F&&((d=n.children)==null?void 0:d.length)===0||n.type===Ge&&n.children.trim()===""))})}var kt=A({name:ie,props:bt,setup(e,{slots:c}){const n=_(()=>{var o;return(o=e.align)!=null?o:e.direction==="horizontal"?"center":""}),d=o=>typeof o=="number"?o+"px":o,m=o=>{const f={},s=`${d(Array.isArray(e.size)?e.size[0]:e.size)}`,i=`${d(Array.isArray(e.size)?e.size[1]:e.size)}`;return o?e.wrap?{marginBottom:i}:{}:(e.direction==="horizontal"&&(f.marginRight=s),(e.direction==="vertical"||e.wrap)&&(f.marginBottom=i),f)};return()=>{var o;const f=be((o=c.default)==null?void 0:o.call(c));return t("div",{class:[gt({[e.direction]:e.direction,[`align-${n.value}`]:n.value,wrap:e.wrap,fill:e.fill})]},[f.map((s,i)=>t("div",{key:`item-${i}`,class:`${ie}-item`,style:m(i===f.length-1)},[s]))])}}});const yt=N(kt),wt=X("div",null,null,-1),Ct={class:"stdout"},_t="/data/adb/modules/xray4magisk/module.prop",xt={__name:"Dashboard",props:["theme"],setup(e){const c=b(!1),n=b(!1),d=b(!1),m=b(!1),o=b(!1),f=b(!1),s=b(""),i=b({result:[]}),v=b([]),h=b(""),y=b(""),r=b({api:"",coreType:"",pid:"",method:"",dataDir:""}),k=b(R.global.t("dashboard.status-core-status-stopped")),g=b(!1),$=()=>{Me(`${r.value.dataDir}/custom.txt`).then(a=>{v.value=a.trim().split(/\s+/),g.value=!0})},T=(a,l)=>{v.value[l]=a},B=a=>{v.value.splice(a,1)},ke=()=>{v.value.push("")},ye=()=>{let a="";for(let l of v.value)a=a+l+`
`;je(a,`${r.value.dataDir}/custom.txt`)},we=[{text:"start",value:"start"},{text:"stop",value:"stop"},{text:"restart",value:"restart"},{text:"status",value:"status"}],Ce=a=>{m.value=!0,n.value=!0,q("service "+a.value).then(l=>{h.value=l})},_e=[{text:"enable",value:"enable"},{text:"disable",value:"disable"},{text:"refresh",value:"refresh"}],$e=a=>{m.value=!0,n.value=!0,q("proxy "+a.value).then(l=>{h.value=l})},I=a=>{m.value=!0,n.value=!0,q("update "+a).then(l=>{h.value=l})},Q=async a=>{n.value=!0,f.value=!0,o.value=a,i.value=a?await U("get switch custom"):await U("get switch");let l=a?localStorage.getItem("switchCustomIdx"):localStorage.getItem("switchIdx");typeof l<"u"&&l!=null?s.value=l:s.value=""},Se=(a,l)=>{let w=a?`set switch custom ${l}`:`set switch ${l}`;U(w).then(V=>{f.value=!1,a?(localStorage.setItem("switchCustomIdx",l),localStorage.removeItem("switchIdx")):(localStorage.setItem("switchIdx",l),localStorage.removeItem("switchCustomIdx")),V.ok?se(R.global.t("dashboard.tool-switch-success")):se(R.global.t("dashboard.tool-switch-failed"))})},G=()=>{y.value="",r.value={api:"",coreType:"",pid:"",method:"",dataDir:""},d.value=!1,k.value=R.global.t("dashboard.status-core-status-stopped"),h.value="",n.value=!1,Z(),ee()},xe=()=>{setTimeout(()=>{G(),c.value=!1},1e3)},Z=()=>{Le("grep version= "+_t).then(a=>{y.value=a.split("=")[1]})},ee=()=>{U("get status").then(a=>{r.value=a,r.value.pid.length>0&&(d.value=!0,k.value=R.global.t("dashboard.status-core-status-running"))})};return Z(),ee(),(a,l)=>{const w=qe,V=We,te=He,ae=yt,S=Xe,x=ft,Pe=pt,Ve=it,ze=tt,L=Oe,le=de,Ae=Je,Be=Ye,Ie=Ke;return E(),H(Ie,{modelValue:c.value,"onUpdate:modelValue":l[11]||(l[11]=p=>c.value=p),disabled:n.value,onRefresh:xe,"pulling-text":a.$t("common.pulling-text"),"loosing-text":a.$t("common.loosing-text"),"loading-text":a.$t("common.loading-text")},{default:u(()=>[t(V,{title:a.$t("dashboard.version"),inset:""},{default:u(()=>[t(w,{title:a.$t("dashboard.version-module"),"title-style":"max-width:35%;",value:y.value,url:"https://github.com/Asterisk4Magisk/Xray4Magisk",clickable:""},null,8,["title","value"]),t(w,{title:a.$t("dashboard.version-dashboard"),"title-style":"max-width:35%;",value:a.$t("common.dashboard-version"),url:"https://github.com/Asterisk4Magisk/xray4magisk-ksu-webui",clickable:""},null,8,["title","value"])]),_:1},8,["title"]),t(V,{title:a.$t("dashboard.status"),inset:""},{default:u(()=>[t(w,{title:a.$t("dashboard.status-core-type"),"title-style":"max-width:35%;",value:r.value.coreType},null,8,["title","value"]),t(te,{actions:we,onSelect:Ce,placement:"bottom-end"},{reference:u(()=>[t(w,{title:a.$t("dashboard.status-core-status"),"title-style":"max-width:35%;",value:k.value,clickable:""},null,8,["title","value"]),wt]),_:1}),O(t(w,{title:a.$t("dashboard.status-core-pid"),"title-style":"max-width:35%;",value:r.value.pid},null,8,["title","value"]),[[K,d.value]]),t(te,{actions:_e,onSelect:$e,placement:"bottom-end"},{reference:u(()=>[t(w,{title:a.$t("dashboard.status-method"),"title-style":"max-width:35%;",value:r.value.method,clickable:""},null,8,["title","value"])]),_:1})]),_:1},8,["title"]),t(V,{title:a.$t("dashboard.tool"),inset:""},{default:u(()=>[t(ae),t(Pe,{gutter:[0,11],justify:"space-around"},{default:u(()=>[t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[0]||(l[0]=p=>I("core"))},{default:u(()=>[P(C(a.$t("dashboard.tool-update-core")),1)]),_:1})]),_:1}),t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[1]||(l[1]=p=>I("geodata"))},{default:u(()=>[P(C(a.$t("dashboard.tool-update-geodata")),1)]),_:1})]),_:1}),t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[2]||(l[2]=p=>I("subscribe"))},{default:u(()=>[P(C(a.$t("dashboard.tool-update-subscribe")),1)]),_:1})]),_:1}),t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[3]||(l[3]=p=>I("yacd-meta"))},{default:u(()=>[P(C(a.$t("dashboard.tool-update-yacd-meta")),1)]),_:1})]),_:1}),t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[4]||(l[4]=p=>I("tun2socks"))},{default:u(()=>[P(C(a.$t("dashboard.tool-update-tun2socks")),1)]),_:1})]),_:1}),t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[5]||(l[5]=p=>Q(!1))},{default:u(()=>[P(C(a.$t("dashboard.tool-switch")),1)]),_:1})]),_:1}),O(t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:l[6]||(l[6]=p=>Q(!0))},{default:u(()=>[P(C(a.$t("dashboard.tool-switch-custom")),1)]),_:1})]),_:1},512),[[K,r.value.coreType!=="mihomo"]]),O(t(x,{span:"11"},{default:u(()=>[t(S,{plain:"",type:"default",block:"",onClick:$},{default:u(()=>[P(C(a.$t("dashboard.tool-switch-custom-edit")),1)]),_:1})]),_:1},512),[[K,r.value.coreType!=="mihomo"]])]),_:1}),t(ae)]),_:1},8,["title"]),t(L,{show:f.value,"onUpdate:show":l[8]||(l[8]=p=>f.value=p),round:"",style:{width:"90%",maxHeight:"85%"},onClosed:G},{default:u(()=>[t(ze,{modelValue:s.value,"onUpdate:modelValue":l[7]||(l[7]=p=>s.value=p)},{default:u(()=>[t(V,{inset:""},{default:u(()=>[(E(!0),oe(F,null,ne(i.value.result,(p,z)=>(E(),H(w,{title:p,clickable:"",onClick:M=>Se(o.value,z)},{"right-icon":u(()=>[t(Ve,{name:z.toString()},null,8,["name"])]),_:2},1032,["title","onClick"]))),256))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"]),t(L,{show:g.value,"onUpdate:show":l[9]||(l[9]=p=>g.value=p),round:"",style:{width:"90%",maxHeight:"85%"},onClosed:ye},{default:u(()=>[t(w,{title:a.$t("dashboard.tool-switch-custom-edit"),"title-style":"max-width:100%;"},{"right-icon":u(()=>[t(le,{size:"1.2rem",name:"plus",onClick:ke})]),_:1},8,["title"]),t(Be,null,{default:u(()=>[(E(!0),oe(F,null,ne(v.value,(p,z)=>(E(),H(Ae,{label:z+":",labelWidth:"1.5em","model-value":p,"onUpdate:modelValue":M=>T(M,z)},{"right-icon":u(()=>[t(le,{size:"1rem",name:"cross",onClick:M=>B(z)},null,8,["onClick"])]),_:2},1032,["label","model-value","onUpdate:modelValue"]))),256))]),_:1})]),_:1},8,["show"]),t(L,{show:m.value,"onUpdate:show":l[10]||(l[10]=p=>m.value=p),round:"",style:{width:"90%",minHeight:"30%",maxHeight:"85%"},onClosed:G},{default:u(()=>[t(w,{title:a.$t("dashboard.stdout"),"title-style":"max-width:100%;",size:"large"},null,8,["title"]),X("div",Ct,[X("p",null,C(h.value),1)])]),_:1},8,["show"])]),_:1},8,["modelValue","disabled","pulling-text","loosing-text","loading-text"])}}};export{xt as default};
