import{c as D,d as I,u as re,w as Te,a as De,b as t,n as Y,e as W,f as E,g as J,m as Ee,t as de,r as b,h as P,I as ce,i as O,j as me,p as Ne,k as Ue,l as ve,o as Fe,F as L,C as Ge,T as Le,q as V,s as T,v as K,x as u,y as Me,z as U,A as F,B as G,D as x,E as C,G as oe,H as ne,J as X,K as je,L as se,M as q,P as He,N as Oe}from"./index-C8RrZcWP.js";import{P as Ke,C as qe,a as We,B as Xe,L as Ye,s as ie,F as Je}from"./index-BUzAXDZq.js";const[he,Qe]=D("radio-group"),Ze={shape:String,disabled:Boolean,iconSize:Y,direction:String,modelValue:W,checkedColor:String},fe=Symbol(he);var et=I({name:he,props:Ze,emits:["change","update:modelValue"],setup(e,{emit:c,slots:n}){const{linkChildren:d}=re(fe),m=o=>c("update:modelValue",o);return Te(()=>e.modelValue,o=>c("change",o)),d({props:e,updateValue:m}),De(()=>e.modelValue),()=>{var o;return t("div",{class:Qe([e.direction]),role:"radiogroup"},[(o=n.default)==null?void 0:o.call(n)])}}});const tt=E(et),ge={name:W,disabled:Boolean,iconSize:Y,modelValue:W,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var at=I({props:J({},ge,{bem:Ee(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:de,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:c,slots:n}){const d=b(),m=r=>{if(e.parent&&e.bindGroup)return e.parent.props[r]},o=P(()=>{if(e.parent&&e.bindGroup){const r=m("disabled")||e.disabled;if(e.role==="checkbox"){const k=m("modelValue").length,p=m("max"),$=p&&k>=+p;return r||$&&!e.checked}return r}return e.disabled}),f=P(()=>m("direction")),s=P(()=>{const r=e.checkedColor||m("checkedColor");if(r&&e.checked&&!o.value)return{borderColor:r,backgroundColor:r}}),i=P(()=>e.shape||m("shape")||"round"),v=r=>{const{target:k}=r,p=d.value,$=p===k||(p==null?void 0:p.contains(k));!o.value&&($||!e.labelDisabled)&&c("toggle"),c("click",r)},h=()=>{var r,k;const{bem:p,checked:$,indeterminate:N}=e,R=e.iconSize||m("iconSize");return t("div",{ref:d,class:p("icon",[i.value,{disabled:o.value,checked:$,indeterminate:N}]),style:i.value!=="dot"?{fontSize:O(R)}:{width:O(R),height:O(R),borderColor:(r=s.value)==null?void 0:r.borderColor}},[n.icon?n.icon({checked:$,disabled:o.value}):i.value!=="dot"?t(ce,{name:N?"minus":"success",style:s.value},null):t("div",{class:p("icon--dot__icon"),style:{backgroundColor:(k=s.value)==null?void 0:k.backgroundColor}},null)])},y=()=>{const{checked:r}=e;if(n.default)return t("span",{class:e.bem("label",[e.labelPosition,{disabled:o.value}])},[n.default({checked:r,disabled:o.value})])};return()=>{const r=e.labelPosition==="left"?[y(),h()]:[h(),y()];return t("div",{role:e.role,class:e.bem([{disabled:o.value,"label-disabled":e.labelDisabled},f.value]),tabindex:o.value?void 0:0,"aria-checked":e.checked,onClick:v},[r])}}});const lt=J({},ge,{shape:String}),[ot,nt]=D("radio");var st=I({name:ot,props:lt,emits:["update:modelValue"],setup(e,{emit:c,slots:n}){const{parent:d}=me(fe),m=()=>(d?d.props.modelValue:e.modelValue)===e.name,o=()=>{d?d.updateValue(e.name):c("update:modelValue",e.name)};return()=>t(at,Ue({bem:nt,role:"radio",parent:d,checked:m(),onToggle:o},e),Ne(n,["default","icon"]))}});const it=E(st),[pe,ut]=D("row"),be=Symbol(pe),rt={tag:ve("div"),wrap:de,align:String,gutter:{type:[String,Number,Array],default:0},justify:String};var dt=I({name:pe,props:rt,setup(e,{slots:c}){const{children:n,linkChildren:d}=re(be),m=P(()=>{const s=[[]];let i=0;return n.forEach((v,h)=>{i+=Number(v.span),i>24?(s.push([h]),i-=24):s[s.length-1].push(h)}),s}),o=P(()=>{let s=0;Array.isArray(e.gutter)?s=Number(e.gutter[0])||0:s=Number(e.gutter);const i=[];return s&&m.value.forEach(v=>{const h=s*(v.length-1)/v.length;v.forEach((y,r)=>{if(r===0)i.push({right:h});else{const k=s-i[y-1].right,p=h-k;i.push({left:k,right:p})}})}),i}),f=P(()=>{const{gutter:s}=e,i=[];if(Array.isArray(s)&&s.length>1){const v=Number(s[1])||0;if(v<=0)return i;m.value.forEach((h,y)=>{y!==m.value.length-1&&h.forEach(()=>{i.push({bottom:v})})})}return i});return d({spaces:o,verticalSpaces:f}),()=>{const{tag:s,wrap:i,align:v,justify:h}=e;return t(s,{class:ut({[`align-${v}`]:v,[`justify-${h}`]:h,nowrap:!i})},{default:()=>{var y;return[(y=c.default)==null?void 0:y.call(c)]}})}}});const[ct,mt]=D("col"),vt={tag:ve("div"),span:Fe(0),offset:Y};var ht=I({name:ct,props:vt,setup(e,{slots:c}){const{parent:n,index:d}=me(be),m=P(()=>{if(!n)return;const{spaces:o,verticalSpaces:f}=n;let s={};if(o&&o.value&&o.value[d.value]){const{left:v,right:h}=o.value[d.value];s={paddingLeft:v?`${v}px`:null,paddingRight:h?`${h}px`:null}}const{bottom:i}=f.value[d.value]||{};return J(s,{marginBottom:i?`${i}px`:null})});return()=>{const{tag:o,span:f,offset:s}=e;return t(o,{style:m.value,class:mt({[f]:f,[`offset-${s}`]:s})},{default:()=>{var i;return[(i=c.default)==null?void 0:i.call(c)]}})}}});const ft=E(ht),gt=E(dt),[ue,pt]=D("space"),bt={align:String,direction:{type:String,default:"horizontal"},size:{type:[Number,String,Array],default:8},wrap:Boolean,fill:Boolean};function ke(e=[]){const c=[];return e.forEach(n=>{Array.isArray(n)?c.push(...n):n.type===L?c.push(...ke(n.children)):c.push(n)}),c.filter(n=>{var d;return!(n&&(n.type===Ge||n.type===L&&((d=n.children)==null?void 0:d.length)===0||n.type===Le&&n.children.trim()===""))})}var kt=I({name:ue,props:bt,setup(e,{slots:c}){const n=P(()=>{var o;return(o=e.align)!=null?o:e.direction==="horizontal"?"center":""}),d=o=>typeof o=="number"?o+"px":o,m=o=>{const f={},s=`${d(Array.isArray(e.size)?e.size[0]:e.size)}`,i=`${d(Array.isArray(e.size)?e.size[1]:e.size)}`;return o?e.wrap?{marginBottom:i}:{}:(e.direction==="horizontal"&&(f.marginRight=s),(e.direction==="vertical"||e.wrap)&&(f.marginBottom=i),f)};return()=>{var o;const f=ke((o=c.default)==null?void 0:o.call(c));return t("div",{class:[pt({[e.direction]:e.direction,[`align-${n.value}`]:n.value,wrap:e.wrap,fill:e.fill})]},[f.map((s,i)=>t("div",{key:`item-${i}`,class:`${ue}-item`,style:m(i===f.length-1)},[s]))])}}});const yt=E(kt),wt=X("div",null,null,-1),Ct={class:"stdout"},$t="/data/adb/modules/xray4magisk/module.prop",xt={__name:"Dashboard",props:["theme"],setup(e){const c=b(!1),n=b(!1),d=b(!1),m=b(!1),o=b(!1),f=b(!1),s=b(""),i=b({result:[]}),v=b([]),h=b(V.global.t("common.waiting-text")),y=b(""),r=b({api:"",coreType:"mihomo",pid:"",method:"",dataDir:""}),k=b(V.global.t("dashboard.status-core-status-stopped")),p=b(!1),$=()=>{je(`${r.value.dataDir}/custom.txt`).then(a=>{v.value=a.trim().split(/\s+/),p.value=!0}).catch(()=>{se("",`${r.value.dataDir}/custom.txt`).then(()=>{$()})})},N=(a,l)=>{v.value[l]=a},R=a=>{v.value.splice(a,1)},ye=()=>{v.value.push("")},we=()=>{let a="";for(let l of v.value)a=a+l+`
`;se(a,`${r.value.dataDir}/custom.txt`)},Ce=[{text:"start",value:"start"},{text:"stop",value:"stop"},{text:"restart",value:"restart"},{text:"status",value:"status"}],$e=a=>{m.value=!0,n.value=!0,setTimeout(()=>{q("service "+a.value).then(l=>{h.value=l})},300)},_e=[{text:"enable",value:"enable"},{text:"disable",value:"disable"},{text:"refresh",value:"refresh"}],Se=a=>{m.value=!0,n.value=!0,setTimeout(()=>{q("proxy "+a.value).then(l=>{h.value=l})},300)},z=a=>{m.value=!0,n.value=!0,setTimeout(()=>{q("update "+a).then(l=>{h.value=l})},300)},Q=async a=>{n.value=!0,f.value=!0,o.value=a,i.value=a?await U("get switch custom"):await U("get switch");let l=a?localStorage.getItem("switchCustomIdx"):localStorage.getItem("switchIdx");typeof l<"u"&&l!=null?s.value=l:s.value=""},xe=(a,l)=>{let w=a?`set switch custom ${l}`:`set switch ${l}`;U(w).then(A=>{f.value=!1,a?(localStorage.setItem("switchCustomIdx",l),localStorage.removeItem("switchIdx")):(localStorage.setItem("switchIdx",l),localStorage.removeItem("switchCustomIdx")),A.ok?ie(V.global.t("dashboard.tool-switch-success")):ie(V.global.t("dashboard.tool-switch-failed"))})},M=()=>{y.value="",r.value={api:"",coreType:"mihomo",pid:"",method:"",dataDir:""},d.value=!1,k.value=V.global.t("dashboard.status-core-status-stopped"),h.value=V.global.t("common.waiting-text"),n.value=!1,Z(),ee()},Pe=()=>{setTimeout(()=>{M(),c.value=!1},500)},Z=()=>{Me("grep version= "+$t).then(a=>{y.value=a.split("=")[1]})},ee=()=>{U("get status").then(a=>{r.value=a,r.value.pid.length>0&&(d.value=!0,k.value=V.global.t("dashboard.status-core-status-running"))})};return Z(),ee(),(a,l)=>{const w=qe,A=We,te=He,ae=yt,_=Xe,S=ft,Ve=gt,ze=it,Ae=tt,j=Oe,le=ce,Be=Je,Ie=Ye,Re=Ke;return T(),K(Re,{modelValue:c.value,"onUpdate:modelValue":l[12]||(l[12]=g=>c.value=g),disabled:n.value,onRefresh:Pe,"pulling-text":a.$t("common.pulling-text"),"loosing-text":a.$t("common.loosing-text"),"loading-text":a.$t("common.loading-text")},{default:u(()=>[t(A,{title:a.$t("dashboard.version"),inset:""},{default:u(()=>[t(w,{title:a.$t("dashboard.version-module"),"title-style":"max-width:35%;",value:y.value,url:"https://github.com/Asterisk4Magisk/Xray4Magisk",clickable:""},null,8,["title","value"]),t(w,{title:a.$t("dashboard.version-dashboard"),"title-style":"max-width:35%;",value:a.$t("common.dashboard-version"),url:"https://github.com/Asterisk4Magisk/xray4magisk-ksu-webui",clickable:""},null,8,["title","value"])]),_:1},8,["title"]),t(A,{title:a.$t("dashboard.status"),inset:""},{default:u(()=>[t(w,{title:a.$t("dashboard.status-core-type"),"title-style":"max-width:35%;",value:r.value.coreType},null,8,["title","value"]),t(te,{actions:Ce,onSelect:$e,placement:"bottom-end"},{reference:u(()=>[t(w,{title:a.$t("dashboard.status-core-status"),"title-style":"max-width:35%;",value:k.value,clickable:""},null,8,["title","value"]),wt]),_:1}),F(t(w,{title:a.$t("dashboard.status-core-pid"),"title-style":"max-width:35%;",value:r.value.pid},null,8,["title","value"]),[[G,d.value]]),t(te,{actions:_e,onSelect:Se,placement:"bottom-end"},{reference:u(()=>[t(w,{title:a.$t("dashboard.status-method"),"title-style":"max-width:35%;",value:r.value.method,clickable:""},null,8,["title","value"])]),_:1})]),_:1},8,["title"]),t(A,{title:a.$t("dashboard.tool"),inset:""},{default:u(()=>[t(ae),t(Ve,{gutter:[0,11],justify:"space-around"},{default:u(()=>[t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[0]||(l[0]=g=>z("core"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-core")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[1]||(l[1]=g=>z("adghome"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-adghome")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[2]||(l[2]=g=>z("geodata"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-geodata")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[3]||(l[3]=g=>z("subscribe"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-subscribe")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[4]||(l[4]=g=>z("yacd-meta"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-yacd-meta")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[5]||(l[5]=g=>z("tun2socks"))},{default:u(()=>[x(C(a.$t("dashboard.tool-update-tun2socks")),1)]),_:1})]),_:1}),t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[6]||(l[6]=g=>Q(!1))},{default:u(()=>[x(C(a.$t("dashboard.tool-switch")),1)]),_:1})]),_:1}),F(t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:l[7]||(l[7]=g=>Q(!0))},{default:u(()=>[x(C(a.$t("dashboard.tool-switch-custom")),1)]),_:1})]),_:1},512),[[G,r.value.coreType!=="mihomo"]]),F(t(S,{span:"11"},{default:u(()=>[t(_,{plain:"",hairline:"",type:"default",block:"",onClick:$},{default:u(()=>[x(C(a.$t("dashboard.tool-switch-custom-edit")),1)]),_:1})]),_:1},512),[[G,r.value.coreType!=="mihomo"]])]),_:1}),F(t(ae,null,null,512),[[G,r.value.coreType!=="mihomo"]])]),_:1},8,["title"]),t(j,{show:f.value,"onUpdate:show":l[9]||(l[9]=g=>f.value=g),round:"",style:{width:"90%",maxHeight:"85%"},onClosed:M},{default:u(()=>[t(Ae,{modelValue:s.value,"onUpdate:modelValue":l[8]||(l[8]=g=>s.value=g)},{default:u(()=>[t(A,{inset:""},{default:u(()=>[(T(!0),oe(L,null,ne(i.value.result,(g,B)=>(T(),K(w,{title:g,clickable:"",onClick:H=>xe(o.value,B)},{"right-icon":u(()=>[t(ze,{name:B.toString()},null,8,["name"])]),_:2},1032,["title","onClick"]))),256))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["show"]),t(j,{show:p.value,"onUpdate:show":l[10]||(l[10]=g=>p.value=g),round:"",style:{width:"90%",maxHeight:"85%"},onClosed:we},{default:u(()=>[t(w,{title:a.$t("dashboard.tool-switch-custom-edit"),"title-style":"max-width:100%;"},{"right-icon":u(()=>[t(le,{size:"1.2rem",name:"plus",onClick:ye})]),_:1},8,["title"]),t(Ie,null,{default:u(()=>[(T(!0),oe(L,null,ne(v.value,(g,B)=>(T(),K(Be,{label:B+":",labelWidth:"1.5em","model-value":g,"onUpdate:modelValue":H=>N(H,B)},{"right-icon":u(()=>[t(le,{size:"1rem",name:"cross",onClick:H=>R(B)},null,8,["onClick"])]),_:2},1032,["label","model-value","onUpdate:modelValue"]))),256))]),_:1})]),_:1},8,["show"]),t(j,{show:m.value,"onUpdate:show":l[11]||(l[11]=g=>m.value=g),round:"",style:{width:"90%",minHeight:"30%",maxHeight:"85%"},onClosed:M},{default:u(()=>[t(w,{title:a.$t("dashboard.stdout"),"title-style":"max-width:100%;",size:"large"},null,8,["title"]),X("div",Ct,[X("p",null,C(h.value),1)])]),_:1},8,["show"])]),_:1},8,["modelValue","disabled","pulling-text","loosing-text","loading-text"])}}};export{xt as default};
